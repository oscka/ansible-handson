---
- hosts: "all"
  tasks:
    - name: "[pre] apt update"
      apt:
        update_cache: yes
      become: true
      tags: k8s-pre


- name: create k8s user
  import_playbook: sub-playbook/playbook-user.yml
  tags: 
    - k8s-user
 

- name: install k8s-tools 
  import_playbook: sub-playbook/playbook-k8s-tools.yml
  tags: 
    - k8s-tools
 

- hosts: "lb4k8s"
  vars: 
  -  ROLES_PATH: /Users/blackstar/dev/workspace/vscode/tools-work/ansible/austine-playbooks/roles
  roles:
    - role: "{{ROLES_PATH}}/k8s-cluster/role-lb-db-k8s"

- hosts: "masters"
  serial: 1
  vars:
  - ROLES_PATH: /Users/blackstar/dev/workspace/vscode/tools-work/ansible/austine-playbooks/roles  
  roles:
    - role: "{{ROLES_PATH}}/k8s-cluster/role-k8s-master"

- hosts: "workers"
  serial: 1
  vars:
  - ROLES_PATH: /Users/blackstar/dev/workspace/vscode/tools-work/ansible/austine-playbooks/roles
  roles:
    - role: "{{ROLES_PATH}}/k8s-cluster/role-k8s-worker"
    
    


